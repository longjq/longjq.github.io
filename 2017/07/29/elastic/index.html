<!DOCTYPE html>




<html class="theme-next pisces" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Testing,Another Tag," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="ʲô��Elasticsearch����Elasticsearch��һЩ˵�� Node���ڵ㣩��������װ��Elasticsearch�������ṩ����ת�ƺ���չ�ķ����� Cluster����Ⱥ����һ����Ⱥ������һ��������node��֯��һ�𣬹�ͬ��������ͬ�����������ݾ��и��ؾ��⹦�ܵļ�Ⱥ Document��">
<meta name="keywords" content="Testing,Another Tag">
<meta property="og:type" content="article">
<meta property="og:title" content="Elasticsearch">
<meta property="og:url" content="http://yoursite.com/2017/07/29/elastic/index.html">
<meta property="og:site_name" content="走走停停">
<meta property="og:description" content="ʲô��Elasticsearch����Elasticsearch��һЩ˵�� Node���ڵ㣩��������װ��Elasticsearch�������ṩ����ת�ƺ���չ�ķ����� Cluster����Ⱥ����һ����Ⱥ������һ��������node��֯��һ�𣬹�ͬ��������ͬ�����������ݾ��и��ؾ��⹦�ܵļ�Ⱥ Document��">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://ss0.bdstatic.com/94oJfD_bAAcT8t7mm9GUKT-xh_/timg?image&quality=100&size=b4000_4000&sec=1472129463&di=6cb8d5b6d510439cd0cfb32654655c6e&src=http://images.cnitblog.com/blog2015/603001/201503/031612296601250.png">
<meta property="og:image" content="c:/Users/Administrator/Pictures/fields.png">
<meta property="og:image" content="c:/Users/Administrator/Pictures/field_fun.png">
<meta property="og:updated_time" content="2017-07-29T02:34:47.226Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Elasticsearch">
<meta name="twitter:description" content="ʲô��Elasticsearch����Elasticsearch��һЩ˵�� Node���ڵ㣩��������װ��Elasticsearch�������ṩ����ת�ƺ���չ�ķ����� Cluster����Ⱥ����һ����Ⱥ������һ��������node��֯��һ�𣬹�ͬ��������ͬ�����������ݾ��и��ؾ��⹦�ܵļ�Ⱥ Document��">
<meta name="twitter:image" content="https://ss0.bdstatic.com/94oJfD_bAAcT8t7mm9GUKT-xh_/timg?image&quality=100&size=b4000_4000&sec=1472129463&di=6cb8d5b6d510439cd0cfb32654655c6e&src=http://images.cnitblog.com/blog2015/603001/201503/031612296601250.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    motion: false,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/07/29/elastic/"/>





  <title>Elasticsearch | 走走停停</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">走走停停</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">开发技术记录</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/29/elastic/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Admin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="走走停停">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Elasticsearch</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-29T10:34:05+08:00">
                2017-07-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Testing/" itemprop="url" rel="index">
                    <span itemprop="name">Testing</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2017/07/29/elastic/" class="leancloud_visitors" data-flag-title="Elasticsearch">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="ʲo��Elasticsearch"><a href="#ʲo��Elasticsearch" class="headerlink" title="ʲô��Elasticsearch"></a>ʲô��Elasticsearch</h3><h4 id="����Elasticsearch��һЩ˵��"><a href="#����Elasticsearch��һЩ˵��" class="headerlink" title="����Elasticsearch��һЩ˵��"></a>����Elasticsearch��һЩ˵��</h4><ul>
<li>Node���ڵ㣩��������װ��Elasticsearch�������ṩ����ת�ƺ���չ�ķ�����</li>
<li>Cluster����Ⱥ����һ����Ⱥ������һ��������node��֯��һ�𣬹�ͬ��������ͬ�����������ݾ��и��ؾ��⹦�ܵļ�Ⱥ</li>
<li>Document���ĵ�����һ���ĵ���һ���ɱ������Ļ�����Ϣ��Ԫ</li>
<li>Index������������������һ��ӵ�м��������������ĵ�����</li>
<li>Type�����ͣ���һ�������У������Զ���һ�ֻ���������</li>
<li>Field���У���Field��Elasticsearch����С��λ���൱�����ݵ�ĳһ��</li>
<li>Shards����Ƭ����Elasticsearch�������ֳ����ɷݣ�ÿ�����־���һ��shard</li>
<li>Replicas�����ƣ���Replicas������һ�ݻ����ݿ���</li>
</ul>
<h4 id="��һ���L�ϵ�����ݿ��KԱ�"><a href="#��һ���L�ϵ�����ݿ��KԱ�" class="headerlink" title="��һ���Ĺ�ϵ�����ݿ��ĶԱ�"></a>��һ���Ĺ�ϵ�����ݿ��ĶԱ�</h4><table>
<thead>
<tr>
<th>��ϵ�����ݿ⣨����mysql��</th>
<th>�ǹ�ϵ�����ݿ⣨Elasticsearch��</th>
</tr>
</thead>
<tbody>
<tr>
<td>���ݿ�Database</td>
<td>����Index</td>
</tr>
<tr>
<td>��Table</td>
<td>����Type</td>
</tr>
<tr>
<td>������Row</td>
<td>�ĵ�Document</td>
</tr>
<tr>
<td>������Column</td>
<td>�ֶ�Field</td>
</tr>
</tbody>
</table>
<h4 id="�ܹ�ͼ"><a href="#�ܹ�ͼ" class="headerlink" title="�ܹ�ͼ"></a>�ܹ�ͼ</h4><p><img src="https://ss0.bdstatic.com/94oJfD_bAAcT8t7mm9GUKT-xh_/timg?image&amp;quality=100&amp;size=b4000_4000&amp;sec=1472129463&amp;di=6cb8d5b6d510439cd0cfb32654655c6e&amp;src=http://images.cnitblog.com/blog2015/603001/201503/031612296601250.png" alt="�ܹ�ͼ"></p>
<h3 id="bulk��������"><a href="#bulk��������" class="headerlink" title="bulk��������"></a>bulk��������</h3><table>
<thead>
<tr>
<th>action����Ϊ��</th>
<th>����</th>
</tr>
</thead>
<tbody>
<tr>
<td>create</td>
<td>���ĵ�������ʱ����</td>
</tr>
<tr>
<td>index</td>
<td>�������ĵ����滻���е��ĵ�</td>
</tr>
<tr>
<td>update</td>
<td>�ֲ������ĵ�</td>
</tr>
<tr>
<td>delete</td>
<td>ɾ��һ���ĵ�</td>
</tr>
</tbody>
</table>
<p>����<code>{&quot;delete&quot;:{&quot;_index&quot;:&quot;library&quot;,&quot;_type&quot;:&quot;books&quot;,&quot;_id&quot;:&quot;1&quot;}}</code></p>
<p>������һЩ��������</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">POST /librarys/books/_bulk</div><div class="line">&#123; &quot;index&quot;: &#123; &quot;_id&quot;:1 &#125; &#125;</div><div class="line">&#123; &quot;title&quot;:&quot;ELASTICSEARCH: THE DEFINETIVE GIDE2&quot;,&quot;price&quot;:5 &#125;</div><div class="line">&#123; &quot;index&quot;: &#123; &quot;_id&quot;:2 &#125; &#125;</div><div class="line">&#123; &quot;title&quot;:&quot;ELASTICSEARCH: cookbook2&quot;,&quot;price&quot;:51 &#125;</div><div class="line">&#123; &quot;index&quot;: &#123; &quot;_id&quot;:3 &#125; &#125;</div><div class="line">&#123; &quot;title&quot;:&quot;THINK IN PHP2&quot;,&quot;price&quot;:5 &#125;</div><div class="line">&#123; &quot;index&quot;: &#123; &quot;_id&quot;:4 &#125; &#125;</div><div class="line">&#123; &quot;title&quot;:&quot;THINK IN PATTERN&quot;,&quot;price&quot;:5 &#125;</div><div class="line">&#123; &quot;index&quot;: &#123; &quot;_id&quot;:5 &#125; &#125;</div><div class="line">&#123; &quot;title&quot;:&quot;HELLO WORLD&quot;,&quot;price&quot;:5 &#125;</div><div class="line"></div><div class="line">GET /librarys/books/_mget</div><div class="line">&#123;</div><div class="line">    &quot;ids&quot; : [&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;]</div><div class="line">&#125;</div><div class="line"></div><div class="line">POST /librarys/books/_bulk</div><div class="line">&#123; &quot;delete&quot;: &#123;&quot;_index&quot;: &quot;librarys&quot;, &quot;_type&quot;: &quot;books&quot;, &quot;_id&quot;: &quot;1&quot;&#125; &#125;</div><div class="line">&#123; &quot;create&quot;: &#123;&quot;_index&quot;: &quot;music&quot;,&quot;_type&quot;:&quot;classical&quot;,&quot;_id&quot;:&quot;1&quot;&#125;&#125;</div><div class="line">&#123; &quot;title&quot;: &quot;love is forvery&quot;&#125;</div><div class="line">&#123; &quot;index&quot;: &#123; &quot;_index&quot;: &quot;music&quot;, &quot;_type&quot;: &quot;classical&quot;&#125;&#125;</div><div class="line">&#123; &quot;title&quot;: &quot;live is forvery&quot;&#125;</div><div class="line">&#123; &quot;update&quot;: &#123; &quot;_index&quot;:&quot;librarys&quot;,&quot;_type&quot;:&quot;books&quot;,&quot;_id&quot;:&quot;2&quot;&#125;&#125;</div><div class="line">&#123; &quot;doc&quot;: &#123;&quot;price&quot;:&quot;99999&quot;&#125;&#125;</div></pre></td></tr></table></figure>
<p><code>PS:�ύ��Body���ݱ���һ��һ��action������һ��Ϊbody���ݣ��м�����Ҫ��\n����</code></p>
<h4 id="bulk�����j���С������ֵ"><a href="#bulk�����j���С������ֵ" class="headerlink" title="bulk�����ĵ���С������ֵ"></a>bulk�����ĵ���С������ֵ</h4><ul>
<li>���ݼ�����ÿ���ڵ�����RAM��</li>
<li>���������ݳ���һ����С����bulk�Ĵ������ܾͻ��½�</li>
<li>�ĵ����ݴ�С��Ӳ�����ã��ĵ����Ӷȣ��Լ���ǰ��Ⱥ�����й�</li>
</ul>
<p><code>PS:�տ�ʼ�����ȴ���Сһ�������ݣ����ݲ����鿴���ܣ�����û�������ټӴ�����������</code></p>
<h3 id="�汾����"><a href="#�汾����" class="headerlink" title="�汾����"></a>�汾����</h3><h4 id="�ֹ����ͱ�����"><a href="#�ֹ����ͱ�����" class="headerlink" title="�ֹ����ͱ�����"></a>�ֹ����ͱ�����</h4><p>���������ٶ��ᷢ��������ͻ������һ�п���Υ�����������ԵĲ���������������ʱ����������������������һЩ��������</p>
<p>�ֹ������ٶ����ᷢ��������ͻ��ֻ���ύ����ʱ�����Ƿ�Υ�����ݵ������ԣ������ύʱ����Ŀ�걻�޸��ˣ����ύʧ�ܣ�ͬʱ�����������Ĳ�ѯ��������Ϊ��Ҫ�������������ԣ��������ݵ�ʵʱ�Խϲ��ȡ�����ݶ���������������</p>
<h4 id="�ڲ��汾���ⲿ�汾"><a href="#�ڲ��汾���ⲿ�汾" class="headerlink" title="�ڲ��汾���ⲿ�汾"></a>�ڲ��汾���ⲿ�汾</h4><p>�ڲ��汾���ƣ�ʹ���Դ���<code>_version</code>���͵��������ؼ��֣��޸����ݺ���<code>_version</code>���Զ���1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"># �½�һ�����ݣ�ע���鿴���ص�_version�ؼ��֣��汾Ϊ1</div><div class="line">PUT /librarys/books/1</div><div class="line">&#123;</div><div class="line">    &quot;title&quot;: &quot;Elasticsearch: THE definetive guid&quot;,</div><div class="line">    &quot;name&quot; : &#123;</div><div class="line">        &quot;first&quot;:&quot;longjq&quot;,</div><div class="line">        &quot;last&quot;:&quot;Tong&quot;</div><div class="line">    &#125;,</div><div class="line">    &quot;publish_date&quot;:&quot;2015-12-12&quot;,</div><div class="line">    &quot;price&quot;:59.99</div><div class="line">&#125;</div><div class="line"></div><div class="line"># ��ѯid=1�����ݣ��鿴_version�汾�ֶΣ��汾Ϊ1</div><div class="line">GET /librarys/books/1</div><div class="line"></div><div class="line"># �޸�id=1�������е��ֶΣ��鿴_version�汾���汾Ϊ2��˵�����޸ĳɹ�</div><div class="line">POST /librarys/books/1/_update</div><div class="line">&#123;</div><div class="line">    &quot;doc&quot;:&#123;</div><div class="line">        &quot;price&quot;:15</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"># ָ���޸�id=1��version=2�����ݣ�����version=3��˵���޸ĳɹ�</div><div class="line">POST /librarys/books/1/_update?version=2</div><div class="line">&#123;</div><div class="line">    &quot;doc&quot;:&#123;</div><div class="line">        &quot;price&quot;:10</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>�ⲿ�汾���ƣ�Ϊ�˱���_version���ⲿ�汾���Ƶ���ֵһ�£�ʹ��version_type=external�ؼ��֣��������ݵ�ǰ��versionֵ�Ƿ�С�������е�versionֵ��ֻ��������versionֵ���������е�versionֵ��ʱ�򣬲����޸ĳɹ�</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"># ���ǲ�����ʹ���ⲿ����version_type=external������ָ��id=1��version�İ汾Ϊversion=15�İ汾</div><div class="line">PUT /librarys/books/1?version=15&amp;version_type=external</div><div class="line">&#123;</div><div class="line">    &quot;title&quot;: &quot;Elasticsearch: THE definetive guid&quot;,</div><div class="line">    &quot;name&quot; : &#123;</div><div class="line">        &quot;first&quot;:&quot;longjq&quot;,</div><div class="line">        &quot;last&quot;:&quot;Tong&quot;</div><div class="line">    &#125;,</div><div class="line">    &quot;publish_date&quot;:&quot;2015-12-12&quot;,</div><div class="line">    &quot;price&quot;:33.33</div><div class="line">&#125;</div><div class="line"># �ⲿ����version�汾�����Ƶİ汾һ��ʱ������ʧ�ܣ�С��Ҳʧ�ܣ����ﲻ��ʾ�������в������ܶ���֮������versionһ��Ҫ���������е�versionֵ</div><div class="line">PUT /librarys/books/1?version=15&amp;version_type=external</div><div class="line">&#123;</div><div class="line">    &quot;title&quot;: &quot;Elasticsearch: THE definetive guid&quot;,</div><div class="line">    &quot;name&quot; : &#123;</div><div class="line">        &quot;first&quot;:&quot;longjq&quot;,</div><div class="line">        &quot;last&quot;:&quot;Tong&quot;</div><div class="line">    &#125;,</div><div class="line">    &quot;publish_date&quot;:&quot;2015-12-12&quot;,</div><div class="line">    &quot;price&quot;:33.33</div><div class="line">&#125;</div><div class="line"></div><div class="line">GET /librarys/books/1</div></pre></td></tr></table></figure>
<p><code>PS:����versionʱ����ֵ����Ϊ����</code></p>
<h3 id="Mapping-ӳ��"><a href="#Mapping-ӳ��" class="headerlink" title="Mapping ӳ��"></a>Mapping ӳ��</h3><h4 id="ʲo��Mappingӳ��"><a href="#ʲo��Mappingӳ��" class="headerlink" title="ʲô��Mappingӳ��"></a>ʲô��Mappingӳ��</h4><p>����������mysql�ı��ṹ������������ʱ����Ԥ�ȶ��������ֶε������Լ����ص�����</p>
<p><code>PS������û������ӳ���Ļ���Elasticsearch���Զ������������ݣ������ֶε�ӳ�䣬������������Ϊ�ֶ�����ӳ����ϵ</code></p>
<h4 id="����ʲo��"><a href="#����ʲo��" class="headerlink" title="����ʲô��"></a>����ʲô��</h4><p>�����������ĸ���ϸ�º�����</p>
<h4 id="ӳ���k���"><a href="#ӳ���k���" class="headerlink" title="ӳ���ķ���"></a>ӳ���ķ���</h4><p>��Ϊ<code>��̬ӳ��</code>��<code>��̬ӳ��</code></p>
<h4 id="�ֶ�����"><a href="#�ֶ�����" class="headerlink" title="�ֶ�����"></a>�ֶ�����</h4><p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-types.html" target="_blank" rel="external">ȥ�����鿴</a></p>
<p><code>PS:��¼��ѧϰ�ʼǵ�ʱ����ʹ�õ���Elasticsearch 2.3�İ汾</code></p>
<p>���½�ͼΪ�����ֶΣ�2.3�汾�����˺ܶ��ֶΣ�����ȥ�����鿴</p>
<p><img src="C:\Users\Administrator\Pictures\fields.png" alt="�����ֶ�"></p>
<h4 id="���Է���"><a href="#���Է���" class="headerlink" title="���Է���"></a>���Է���</h4><p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-params.html" target="_blank" rel="external">ȥ�����鿴</a></p>
<p>���˶����ֶ����ͣ������Ը��ֶ�������������</p>
<p>���������������Է�����</p>
<p>�ֶ�������Լ���������������͸�ʽ�����Է����Ǹ���λ�õ��ֶ��������ص����ԣ����Բ�ͬ��������ͬ��Ч����������mysql��default��������������</p>
<p>��ͼ�ǳ������Է���</p>
<p><img src="C:\Users\Administrator\Pictures\field_fun.png" alt="�������Է���"></p>
<h4 id="��̬ӳ��"><a href="#��̬ӳ��" class="headerlink" title="��̬ӳ��"></a>��̬ӳ��</h4><ul>
<li>ʲô�Ƕ�̬ӳ��</li>
</ul>
<p>�ĵ�������һ����ǰû�������ֶ�ʱ����̬ӳ���Զ��������ֶε����ͣ����Ը��ֶ�����ӳ��</p>
<ul>
<li>�������ö�̬ӳ��</li>
</ul>
<p>ͨ��dynamic���Խ��п���</p>
<p>true��Ĭ��ֵ����̬�����Զ���false���������Զ���strict������İ���Զ����׳��쳣��</p>
<ul>
<li>���÷�Χ</li>
</ul>
<p>�����ڸ������ϻ���object���͵������ֶ���</p>
<h4 id="������ʾ"><a href="#������ʾ" class="headerlink" title="������ʾ"></a>������ʾ</h4><ul>
<li>�����Ͳ鿴ӳ��</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"># ����ӳ��</div><div class="line">POST /library</div><div class="line">&#123;</div><div class="line">    <span class="attr">"settings"</span>: &#123;</div><div class="line">        <span class="attr">"number_of_shards"</span>:<span class="number">5</span>,</div><div class="line">        <span class="attr">"number_of_replicas"</span>: <span class="number">1</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"mappings"</span>: &#123;</div><div class="line">        <span class="attr">"books"</span>: &#123;</div><div class="line">            <span class="attr">"properties"</span>: &#123;</div><div class="line">                <span class="attr">"title"</span>: &#123; <span class="attr">"type"</span>: <span class="string">"string"</span> &#125;,</div><div class="line">                <span class="attr">"name"</span>: &#123; <span class="attr">"type"</span>: <span class="string">"string"</span>, <span class="attr">"index"</span>: <span class="string">"not_analyzed"</span> &#125;,</div><div class="line">                <span class="attr">"publish_date"</span>: &#123; <span class="attr">"type"</span>: <span class="string">"date"</span>, <span class="attr">"index"</span> : <span class="string">"not_analyzed"</span>&#125;,</div><div class="line">                <span class="attr">"price"</span>: &#123; <span class="attr">"type"</span>: <span class="string">"double"</span> &#125;,</div><div class="line">                <span class="attr">"number"</span>: &#123; <span class="attr">"type"</span>: <span class="string">"integer"</span> &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"># ��̬ӳ��(ע�⣺2.3�İ汾ò���Ѿ��޸ģ��ô������鿴�����ĵ�)</div><div class="line">PUT /library</div><div class="line">&#123;</div><div class="line">    <span class="attr">"mappings"</span>: &#123;</div><div class="line">        <span class="attr">"books"</span>: &#123;</div><div class="line">            <span class="attr">"dynamic"</span>: <span class="string">"strict"</span>,</div><div class="line">            <span class="attr">"properties"</span>: &#123;</div><div class="line">                <span class="attr">"title"</span>: &#123; <span class="attr">"type"</span>: <span class="string">"string"</span> &#125;,</div><div class="line">                <span class="attr">"name"</span>: &#123; <span class="attr">"type"</span>: <span class="string">"string"</span>, <span class="attr">"index"</span>: <span class="string">"not_analyzed"</span> &#125;,</div><div class="line">                <span class="attr">"publish_date"</span>: &#123; <span class="attr">"type"</span>: <span class="string">"date"</span>, <span class="attr">"index"</span> : <span class="string">"not_analyzed"</span>&#125;,</div><div class="line">                <span class="attr">"price"</span>: &#123; <span class="attr">"type"</span>: <span class="string">"double"</span> &#125;,</div><div class="line">                <span class="attr">"number"</span>: &#123; </div><div class="line">                    <span class="attr">"type"</span>: <span class="string">"object"</span>,</div><div class="line">                    <span class="attr">"dynamic"</span>: <span class="literal">true</span></div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"># �鿴library������Ϣ������ӳ����Ϣ</div><div class="line">GET /library</div><div class="line"></div><div class="line"># ��ȡlibrary����ӳ����Ϣ</div><div class="line">GET /library/_mapping</div><div class="line"></div><div class="line"># ��ȡlibrary�����µ�booksӳ����Ϣ</div><div class="line">GET /library/_mapping/books</div><div class="line"></div><div class="line"># ��ȡ������Ⱥ�ڵ�������Ϣ</div><div class="line">GET /_all/_mapping</div><div class="line"></div><div class="line"># ��ȡ������Ⱥ�ڵ�typeΪbooks��music��ӳ����Ϣ</div><div class="line">GET /_all/_mapping/books,music</div></pre></td></tr></table></figure>
<ul>
<li>ɾ��ӳ��</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># ɾ��ӳ��</div><div class="line">DELETE /library/books/_mapping</div><div class="line">DELETE /library/_mapping/books</div></pre></td></tr></table></figure>
<ul>
<li>����ӳ��</li>
</ul>
<p>���ź���Mappingӳ��һ���������Ͳ����޸ģ�����</p>
<p>ֻ���½�����һ��������Ȼ����֮ǰ�����ݵ��뵽�µ�������</p>
<p>————��������—————<br>1.��������������һ�����������Ұ����е�����ָ����������</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">PUT /��������/_alias/����A</div></pre></td></tr></table></figure>
<p>2.�´���һ����������������Ҫ��ӳ��</p>
<p>3.�ѱ���ָ���µ���������ȡ��֮ǰ��������ָ��</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">POST /_aliases</div><div class="line">&#123;</div><div class="line">	&quot;actions&quot;:[</div><div class="line">  		&#123; &quot;remove&quot;: &#123; &quot;index&quot;: &quot;����������&quot;,&quot;alias&quot;: &quot;����A&quot; &#125; &#125;��</div><div class="line">  		&#123; &quot;add&quot;: &#123; &quot;index&quot;: &quot;�½�������&quot;,&quot;alias&quot;: &quot;����A&quot; &#125; &#125;��</div><div class="line">	]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ͨ��������������ʵ������ƽ�����ɣ�������ͣ��ִ��</p>
<h3 id="��ѯ"><a href="#��ѯ" class="headerlink" title="��ѯ"></a>��ѯ</h3><h4 id="������ѯ"><a href="#������ѯ" class="headerlink" title="������ѯ"></a>������ѯ</h4><p>����Elasticsearch���ò�ѯ�������в�ѯ���ĵ�������ʾ������</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line">GET /library/books/</div><div class="line"></div><div class="line"># ָ��index���Լ�type��������</div><div class="line">GET /library/books/_search?q=title:ELASTICSEARCH</div><div class="line"></div><div class="line"># ָ��index��û��type������������type��������</div><div class="line">GET /library/_search?q=title:ELASTICSEARCH</div><div class="line"></div><div class="line"># û��index��Ҳû��type������������index��������</div><div class="line">GET /_search?q=title:ELASTICSEARCH</div><div class="line"></div><div class="line">#------------------------------------------------</div><div class="line"># term��ѯ</div><div class="line"># term��ѯ����ѯĳ�ֶ�����ĳ���ؼ��ֵ��ĵ�</div><div class="line">GET /library/books/_search</div><div class="line">&#123;</div><div class="line">    <span class="attr">"query"</span>: &#123;</div><div class="line">        <span class="attr">"term"</span>: &#123;</div><div class="line">            <span class="attr">"preview"</span>: <span class="string">"ut"</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"># terms��ѯ����ѯĳ���ֶ��ж����ؼ��ʵ��ĵ�</div><div class="line"># minimum_match����Сƥ�䣬1 ˵�������ؼ���������Ҫ��һ�� 2 ˵���ĵ��������ؼ��ʱ�������</div><div class="line"># minimum_match �ò�����2.3�İ汾�в�֧����terms��ʹ���ˣ���ȥ������ѯ</div><div class="line">GET /library/books/_search</div><div class="line">&#123;</div><div class="line">    <span class="attr">"query"</span>:&#123;</div><div class="line">        <span class="attr">"terms"</span>: &#123;</div><div class="line">           <span class="attr">"preview"</span>: [</div><div class="line">              <span class="string">"doloremque"</span>,</div><div class="line">              <span class="string">"Odit"</span></div><div class="line">           ],</div><div class="line">          <span class="attr">"minimum_match"</span>: <span class="number">2</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"># -----------------------------------------------</div><div class="line"></div><div class="line"></div><div class="line">GET /library/books/_search?q=title:ELASTICSEARCH</div><div class="line"></div><div class="line"># ���Ʋ�ѯ��������</div><div class="line"># �൱��mysql�е�limit</div><div class="line"># form �����ĸ�������ʼ���أ�2.3�汾�У����ͱ��������˶�������ȥ������ѯ</div><div class="line"># size �����巵�������Ľ�����</div><div class="line">GET /library/books/_search</div><div class="line">&#123;</div><div class="line">    <span class="attr">"from"</span>: <span class="number">0</span>,</div><div class="line">    <span class="attr">"size"</span>: <span class="number">20</span>,</div><div class="line">    <span class="attr">"query"</span>: &#123;</div><div class="line">        <span class="attr">"term"</span>: &#123;</div><div class="line">           <span class="attr">"title"</span>: &#123;</div><div class="line">              <span class="attr">"value"</span>: <span class="string">"ELASTICSEARCH"</span></div><div class="line">           &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="���ϲ�ѯ"><a href="#���ϲ�ѯ" class="headerlink" title="���ϲ�ѯ"></a>���ϲ�ѯ</h4><p>�Ѷ���������ѯ������һ���ĸ����Բ�ѯ</p>
<h4 id="����"><a href="#����" class="headerlink" title="����"></a>����</h4><p>��ѯͬʱ��ͨ��filter�����ڲ�Ӱ�����ֵ�������ɸѡ����Ҫ������</p>
<p>library����</p>
<p><span id="library"></span></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">    &#123;</div><div class="line">        <span class="attr">"title"</span>: <span class="string">"minima"</span>,</div><div class="line">        <span class="attr">"price"</span>: <span class="number">49.45</span>,</div><div class="line">        <span class="attr">"preview"</span>: <span class="string">"Earum inventore velit quidem incidunt alias rem esse pariatur. Laborum sed quo nulla consectetur voluptatem consequatur delectus. Culpa quo tempora atque explicabo sed officia eos consequatur."</span>,</div><div class="line">        <span class="attr">"publish_date"</span>: <span class="string">"2011-02-13"</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">        <span class="attr">"title"</span>: <span class="string">"eveniet"</span>,</div><div class="line">        <span class="attr">"price"</span>: <span class="number">46.59</span>,</div><div class="line">        <span class="attr">"preview"</span>: <span class="string">"Aliquam necessitatibus nostrum pariatur ut hic. Voluptatum rerum occaecati natus nostrum dolor. Quibusdam omnis quod voluptas nostrum."</span>,</div><div class="line">        <span class="attr">"publish_date"</span>: <span class="string">"1986-10-27"</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">        <span class="attr">"title"</span>: <span class="string">"voluptatem"</span>,</div><div class="line">        <span class="attr">"price"</span>: <span class="number">29.99</span>,</div><div class="line">        <span class="attr">"preview"</span>: <span class="string">"Voluptatem a recusandae inventore error. Ut et beatae nulla enim saepe et. Pariatur fuga quam ut. Ducimus qui ut est ut dolor."</span>,</div><div class="line">        <span class="attr">"publish_date"</span>: <span class="string">"2012-07-12"</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">        <span class="attr">"title"</span>: <span class="string">"tempore"</span>,</div><div class="line">        <span class="attr">"price"</span>: <span class="number">74.42</span>,</div><div class="line">        <span class="attr">"preview"</span>: <span class="string">"Eveniet facilis dolor repellat nesciunt eum quas. Ipsa ab harum et et. Autem fuga voluptas modi omnis ad et. Inventore in autem cum atque molestiae odit perferendis."</span>,</div><div class="line">        <span class="attr">"publish_date"</span>: <span class="string">"1981-11-26"</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">        <span class="attr">"title"</span>: <span class="string">"voluptatem"</span>,</div><div class="line">        <span class="attr">"price"</span>: <span class="number">99.97</span>,</div><div class="line">        <span class="attr">"preview"</span>: <span class="string">"Dolores quis expedita libero id neque. Non est culpa perspiciatis repudiandae deserunt quaerat eius. Quo laboriosam officiis voluptate voluptas quia corporis ut."</span>,</div><div class="line">        <span class="attr">"publish_date"</span>: <span class="string">"1987-01-05"</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">        <span class="attr">"title"</span>: <span class="string">"dolores"</span>,</div><div class="line">        <span class="attr">"price"</span>: <span class="number">35.27</span>,</div><div class="line">        <span class="attr">"preview"</span>: <span class="string">"Porro atque necessitatibus sed doloremque qui. Enim dolores illum dolorum qui incidunt."</span>,</div><div class="line">        <span class="attr">"publish_date"</span>: <span class="string">"2006-03-19"</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">        <span class="attr">"title"</span>: <span class="string">"pariatur"</span>,</div><div class="line">        <span class="attr">"price"</span>: <span class="number">22.87</span>,</div><div class="line">        <span class="attr">"preview"</span>: <span class="string">"Quis facere blanditiis voluptatem at non aperiam ab ut. Voluptatum ipsum necessitatibus et et. Voluptatem culpa quia architecto. Deleniti aut officia temporibus est."</span>,</div><div class="line">        <span class="attr">"publish_date"</span>: <span class="string">"1982-09-09"</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">        <span class="attr">"title"</span>: <span class="string">"et"</span>,</div><div class="line">        <span class="attr">"price"</span>: <span class="number">37.13</span>,</div><div class="line">        <span class="attr">"preview"</span>: <span class="string">"Odit doloremque magni accusamus cupiditate soluta nam assumenda qui. Labore nulla voluptatem reiciendis. Excepturi ex sapiente dolor aut totam provident. Velit et ut adipisci quaerat nihil qui."</span>,</div><div class="line">        <span class="attr">"publish_date"</span>: <span class="string">"2015-09-25"</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">        <span class="attr">"title"</span>: <span class="string">"maxime"</span>,</div><div class="line">        <span class="attr">"price"</span>: <span class="number">8.78</span>,</div><div class="line">        <span class="attr">"preview"</span>: <span class="string">"Quaerat eos repudiandae inventore. Voluptates qui est illum ad sed. Necessitatibus ab pariatur quod."</span>,</div><div class="line">        <span class="attr">"publish_date"</span>: <span class="string">"2011-10-31"</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">        <span class="attr">"title"</span>: <span class="string">"aspernatur"</span>,</div><div class="line">        <span class="attr">"price"</span>: <span class="number">40.39</span>,</div><div class="line">        <span class="attr">"preview"</span>: <span class="string">"Aut quibusdam tempora rerum. Doloremque tempore laborum dolores mollitia fugiat. Nemo blanditiis exercitationem occaecati modi repudiandae."</span>,</div><div class="line">        <span class="attr">"publish_date"</span>: <span class="string">"2008-01-06"</span></div><div class="line">    &#125;</div><div class="line">]</div></pre></td></tr></table></figure>
<p></p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Testing/" rel="tag"># Testing</a>
          
            <a href="/tags/Another-Tag/" rel="tag"># Another Tag</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/07/29/hello-world/" rel="next" title="Hello World">
                <i class="fa fa-chevron-left"></i> Hello World
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Admin" />
          <p class="site-author-name" itemprop="name">Admin</p>
           
              <p class="site-description motion-element" itemprop="description">每个人都会经过这个阶段，见到一座山，就想知道山后面是什么。我很想告诉他，可能翻过山后面，你会发现没什么特别。回望之下，可能会觉得这一边更好。</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">1</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">标签</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#ʲo��Elasticsearch"><span class="nav-number">1.</span> <span class="nav-text">ʲô��Elasticsearch</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#����Elasticsearch��һЩ˵��"><span class="nav-number">1.1.</span> <span class="nav-text">����Elasticsearch��һЩ˵��</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#��һ���L�ϵ�����ݿ��KԱ�"><span class="nav-number">1.2.</span> <span class="nav-text">��һ���Ĺ�ϵ�����ݿ��ĶԱ�</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#�ܹ�ͼ"><span class="nav-number">1.3.</span> <span class="nav-text">�ܹ�ͼ</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#bulk��������"><span class="nav-number">2.</span> <span class="nav-text">bulk��������</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#bulk�����j���С������ֵ"><span class="nav-number">2.1.</span> <span class="nav-text">bulk�����ĵ���С������ֵ</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#�汾����"><span class="nav-number">3.</span> <span class="nav-text">�汾����</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#�ֹ����ͱ�����"><span class="nav-number">3.1.</span> <span class="nav-text">�ֹ����ͱ�����</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#�ڲ��汾���ⲿ�汾"><span class="nav-number">3.2.</span> <span class="nav-text">�ڲ��汾���ⲿ�汾</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Mapping-ӳ��"><span class="nav-number">4.</span> <span class="nav-text">Mapping ӳ��</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ʲo��Mappingӳ��"><span class="nav-number">4.1.</span> <span class="nav-text">ʲô��Mappingӳ��</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#����ʲo��"><span class="nav-number">4.2.</span> <span class="nav-text">����ʲô��</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ӳ���k���"><span class="nav-number">4.3.</span> <span class="nav-text">ӳ���ķ���</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#�ֶ�����"><span class="nav-number">4.4.</span> <span class="nav-text">�ֶ�����</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#���Է���"><span class="nav-number">4.5.</span> <span class="nav-text">���Է���</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#��̬ӳ��"><span class="nav-number">4.6.</span> <span class="nav-text">��̬ӳ��</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#������ʾ"><span class="nav-number">4.7.</span> <span class="nav-text">������ʾ</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#��ѯ"><span class="nav-number">5.</span> <span class="nav-text">��ѯ</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#������ѯ"><span class="nav-number">5.1.</span> <span class="nav-text">������ѯ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#���ϲ�ѯ"><span class="nav-number">5.2.</span> <span class="nav-text">���ϲ�ѯ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#����"><span class="nav-number">5.3.</span> <span class="nav-text">����</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Admin</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

  
  <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.1"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  






  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("BTJUorSquzFW57Ho7YaiDVEJ-gzGzoHsz", "rVXfsh2tda6hI7iby82ImVwF");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  

  

  

</body>
</html>
